<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>浏览器 | 皮卡丘博客</title>
    <meta name="description" content="操千曲而后晓声 观千剑而后识器">
    <link rel="icon" href="/syBlog/pkq.jpeg">
    
    <link rel="preload" href="/syBlog/assets/css/0.styles.302bd28f.css" as="style"><link rel="preload" href="/syBlog/assets/js/app.a437376f.js" as="script"><link rel="preload" href="/syBlog/assets/js/46.6e1f18b0.js" as="script"><link rel="prefetch" href="/syBlog/assets/js/10.ee33b3f5.js"><link rel="prefetch" href="/syBlog/assets/js/11.3718baca.js"><link rel="prefetch" href="/syBlog/assets/js/12.de9cd000.js"><link rel="prefetch" href="/syBlog/assets/js/13.27203d70.js"><link rel="prefetch" href="/syBlog/assets/js/14.f7abf074.js"><link rel="prefetch" href="/syBlog/assets/js/15.c086b7ea.js"><link rel="prefetch" href="/syBlog/assets/js/16.f7354e27.js"><link rel="prefetch" href="/syBlog/assets/js/17.c1e34b5b.js"><link rel="prefetch" href="/syBlog/assets/js/18.ed202478.js"><link rel="prefetch" href="/syBlog/assets/js/19.10e077de.js"><link rel="prefetch" href="/syBlog/assets/js/2.041caa87.js"><link rel="prefetch" href="/syBlog/assets/js/20.12745d0f.js"><link rel="prefetch" href="/syBlog/assets/js/21.3e6506d9.js"><link rel="prefetch" href="/syBlog/assets/js/22.fb1a8ac6.js"><link rel="prefetch" href="/syBlog/assets/js/23.ad424734.js"><link rel="prefetch" href="/syBlog/assets/js/24.5b2df2ad.js"><link rel="prefetch" href="/syBlog/assets/js/25.287ad44c.js"><link rel="prefetch" href="/syBlog/assets/js/26.642ff326.js"><link rel="prefetch" href="/syBlog/assets/js/27.f0f2f31a.js"><link rel="prefetch" href="/syBlog/assets/js/28.bc5bfca3.js"><link rel="prefetch" href="/syBlog/assets/js/29.da76d747.js"><link rel="prefetch" href="/syBlog/assets/js/3.7a0da7d9.js"><link rel="prefetch" href="/syBlog/assets/js/30.18279763.js"><link rel="prefetch" href="/syBlog/assets/js/31.480f0a33.js"><link rel="prefetch" href="/syBlog/assets/js/32.1d5956dc.js"><link rel="prefetch" href="/syBlog/assets/js/33.3e708b82.js"><link rel="prefetch" href="/syBlog/assets/js/34.27476279.js"><link rel="prefetch" href="/syBlog/assets/js/35.314cb3ee.js"><link rel="prefetch" href="/syBlog/assets/js/36.bcd316c7.js"><link rel="prefetch" href="/syBlog/assets/js/37.702c44a4.js"><link rel="prefetch" href="/syBlog/assets/js/38.888f06ad.js"><link rel="prefetch" href="/syBlog/assets/js/39.1646acc4.js"><link rel="prefetch" href="/syBlog/assets/js/4.e5ff62f4.js"><link rel="prefetch" href="/syBlog/assets/js/40.54e349d4.js"><link rel="prefetch" href="/syBlog/assets/js/41.6860ba2e.js"><link rel="prefetch" href="/syBlog/assets/js/42.c70a8cf2.js"><link rel="prefetch" href="/syBlog/assets/js/43.957ec1dd.js"><link rel="prefetch" href="/syBlog/assets/js/44.b793b16b.js"><link rel="prefetch" href="/syBlog/assets/js/45.1bed48fa.js"><link rel="prefetch" href="/syBlog/assets/js/47.14c7bcfe.js"><link rel="prefetch" href="/syBlog/assets/js/48.6842edb1.js"><link rel="prefetch" href="/syBlog/assets/js/49.495d03f8.js"><link rel="prefetch" href="/syBlog/assets/js/5.dc843bc2.js"><link rel="prefetch" href="/syBlog/assets/js/50.1dc06599.js"><link rel="prefetch" href="/syBlog/assets/js/51.e416e636.js"><link rel="prefetch" href="/syBlog/assets/js/52.1d6a01a6.js"><link rel="prefetch" href="/syBlog/assets/js/53.361d44bd.js"><link rel="prefetch" href="/syBlog/assets/js/54.4f8034bf.js"><link rel="prefetch" href="/syBlog/assets/js/55.b3045951.js"><link rel="prefetch" href="/syBlog/assets/js/56.4a55572f.js"><link rel="prefetch" href="/syBlog/assets/js/57.389473ae.js"><link rel="prefetch" href="/syBlog/assets/js/58.af62ae97.js"><link rel="prefetch" href="/syBlog/assets/js/59.96ca446f.js"><link rel="prefetch" href="/syBlog/assets/js/6.8aa2c987.js"><link rel="prefetch" href="/syBlog/assets/js/60.a08edc84.js"><link rel="prefetch" href="/syBlog/assets/js/61.5370812c.js"><link rel="prefetch" href="/syBlog/assets/js/62.8d8aab53.js"><link rel="prefetch" href="/syBlog/assets/js/63.6a78976b.js"><link rel="prefetch" href="/syBlog/assets/js/64.ea809fc1.js"><link rel="prefetch" href="/syBlog/assets/js/65.3824484a.js"><link rel="prefetch" href="/syBlog/assets/js/7.cfe89f94.js"><link rel="prefetch" href="/syBlog/assets/js/8.333f5770.js"><link rel="prefetch" href="/syBlog/assets/js/9.e15b46dc.js">
    <link rel="stylesheet" href="/syBlog/assets/css/0.styles.302bd28f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/syBlog/" class="home-link router-link-active"><!----> <span class="site-name">皮卡丘博客</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">软基</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/syBlog/computerBasics/dataAndAlg/" class="nav-link">数据结构</a></li><li class="dropdown-item"><!----> <a href="/syBlog/computerBasics/algorithm/" class="nav-link">算法</a></li><li class="dropdown-item"><!----> <a href="/syBlog/computerBasics/designPattern/" class="nav-link">模式和原则</a></li><li class="dropdown-item"><!----> <a href="/syBlog/computerBasics/basic/" class="nav-link">网络协议</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">前端体系</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/syBlog/fontEnd/CSS/" class="nav-link">CSS</a></li><li class="dropdown-item"><!----> <a href="/syBlog/fontEnd/JS/" class="nav-link">JS</a></li><li class="dropdown-item"><!----> <a href="/syBlog/fontEnd/Browser/" aria-current="page" class="nav-link router-link-exact-active router-link-active">浏览器</a></li><li class="dropdown-item"><!----> <a href="/syBlog/fontEnd/API/" class="nav-link">API</a></li><li class="dropdown-item"><!----> <a href="/syBlog/fontEnd/Node/" class="nav-link">Node</a></li><li class="dropdown-item"><!----> <a href="/syBlog/fontEnd/deepKnow/" class="nav-link">场景深入</a></li><li class="dropdown-item"><!----> <a href="/syBlog/fontEnd/RollupTools/" class="nav-link">前端工程化</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">OTHER</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/syBlog/Other/GoodQS/" class="nav-link">好问题</a></li><li class="dropdown-item"><!----> <a href="/syBlog/Other/English/" class="nav-link">英文</a></li><li class="dropdown-item"><!----> <a href="/syBlog/Other/mobileQS/" class="nav-link">移动端问题</a></li><li class="dropdown-item"><!----> <a href="/syBlog/Other/fontendLink/" class="nav-link">好文连接</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">LeetCode</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/syBlog/Leetcode/LinkedList/" class="nav-link">链表</a></li></ul></div></div> <a href="https://github.com/facebook201/sy-fontend-system" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">软基</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/syBlog/computerBasics/dataAndAlg/" class="nav-link">数据结构</a></li><li class="dropdown-item"><!----> <a href="/syBlog/computerBasics/algorithm/" class="nav-link">算法</a></li><li class="dropdown-item"><!----> <a href="/syBlog/computerBasics/designPattern/" class="nav-link">模式和原则</a></li><li class="dropdown-item"><!----> <a href="/syBlog/computerBasics/basic/" class="nav-link">网络协议</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">前端体系</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/syBlog/fontEnd/CSS/" class="nav-link">CSS</a></li><li class="dropdown-item"><!----> <a href="/syBlog/fontEnd/JS/" class="nav-link">JS</a></li><li class="dropdown-item"><!----> <a href="/syBlog/fontEnd/Browser/" aria-current="page" class="nav-link router-link-exact-active router-link-active">浏览器</a></li><li class="dropdown-item"><!----> <a href="/syBlog/fontEnd/API/" class="nav-link">API</a></li><li class="dropdown-item"><!----> <a href="/syBlog/fontEnd/Node/" class="nav-link">Node</a></li><li class="dropdown-item"><!----> <a href="/syBlog/fontEnd/deepKnow/" class="nav-link">场景深入</a></li><li class="dropdown-item"><!----> <a href="/syBlog/fontEnd/RollupTools/" class="nav-link">前端工程化</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">OTHER</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/syBlog/Other/GoodQS/" class="nav-link">好问题</a></li><li class="dropdown-item"><!----> <a href="/syBlog/Other/English/" class="nav-link">英文</a></li><li class="dropdown-item"><!----> <a href="/syBlog/Other/mobileQS/" class="nav-link">移动端问题</a></li><li class="dropdown-item"><!----> <a href="/syBlog/Other/fontendLink/" class="nav-link">好文连接</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">LeetCode</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/syBlog/Leetcode/LinkedList/" class="nav-link">链表</a></li></ul></div></div> <a href="https://github.com/facebook201/sy-fontend-system" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav> <div class="load-success"><div id="codefund"></div></div> <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>浏览器</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/syBlog/fontEnd/Browser/" aria-current="page" class="active sidebar-link">浏览器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/syBlog/fontEnd/Browser/#url-输入到回车发生了什么" class="sidebar-link">URL 输入到回车发生了什么</a></li><li class="sidebar-sub-header"><a href="/syBlog/fontEnd/Browser/#性能" class="sidebar-link">性能</a></li><li class="sidebar-sub-header"><a href="/syBlog/fontEnd/Browser/#webpack" class="sidebar-link">Webpack</a></li><li class="sidebar-sub-header"><a href="/syBlog/fontEnd/Browser/#安全" class="sidebar-link">安全</a></li><li class="sidebar-sub-header"><a href="/syBlog/fontEnd/Browser/#session" class="sidebar-link">session</a></li><li class="sidebar-sub-header"><a href="/syBlog/fontEnd/Browser/#cookie" class="sidebar-link">cookie</a></li><li class="sidebar-sub-header"><a href="/syBlog/fontEnd/Browser/#token-2" class="sidebar-link">token</a></li><li class="sidebar-sub-header"><a href="/syBlog/fontEnd/Browser/#跨域" class="sidebar-link">跨域</a></li><li class="sidebar-sub-header"><a href="/syBlog/fontEnd/Browser/#webscoket" class="sidebar-link">webscoket</a></li><li class="sidebar-sub-header"><a href="/syBlog/fontEnd/Browser/#socket" class="sidebar-link">Socket</a></li></ul></li><li><a href="/syBlog/fontEnd/Browser/browser.html" class="sidebar-link">工作原理</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="浏览器"><a href="#浏览器" class="header-anchor">#</a> 浏览器</h1> <h2 id="url-输入到回车发生了什么"><a href="#url-输入到回车发生了什么" class="header-anchor">#</a> URL 输入到回车发生了什么</h2> <ul><li>URL解析</li> <li>DNS解析</li> <li>TCP连接</li> <li>处理请求</li> <li>接受响应</li> <li>渲染页面</li></ul> <h3 id="gpu渲染页面"><a href="#gpu渲染页面" class="header-anchor">#</a> GPU渲染页面</h3> <ul><li><strong>当改变一个元素的尺寸位置属性时，会重新布局 绘制 以及后面所有的流程，这个称之为重排，</strong></li> <li><strong>当改变颜色属性，不会重排 但还是会触发样式计算和绘制，这个就是重绘</strong></li></ul> <p><strong>页面以每秒60帧刷新率（16ms）才不会卡顿，所以如果页面绘制和布局完成还有剩余时间，js就拿到主线程的使用权，如果js执行时间过长，就会导致下一帧js没有归还主线程给页面重绘，导致下一帧动画没有按时渲染，就会产生卡顿</strong></p> <blockquote><p>可以通过 requesetAnimationFrame() API 来优化 告诉浏览器——你希望执行一个动画，并且要求浏览器在下次重绘之前调用指定的回调函数更新动画。该方法需要传入一个回调函数作为参数，该回调函数会在浏览器下一次重绘之前执行</p></blockquote> <h2 id="性能"><a href="#性能" class="header-anchor">#</a> 性能</h2> <h3 id="网络相关"><a href="#网络相关" class="header-anchor">#</a> 网络相关</h3> <ul><li>DNS域解析</li></ul> <h3 id="强缓存"><a href="#强缓存" class="header-anchor">#</a> 强缓存</h3> <p>实现强缓存可以通过两种响应头实现：<code>Expires</code> 和 <code>Cache-Control</code> 。强缓存表示在缓存期间不需要请求，<code>state code</code> 为 200。</p> <div class="language-bash extra-class"><pre class="language-bash"><code>Expires: Wed, <span class="token number">22</span> Oct <span class="token number">2018</span> 08:41:00 GMT
Cache-control: max-age<span class="token operator">=</span><span class="token number">30</span>
</code></pre></div><p><code>Expires</code> 是 HTTP / 1.0 的产物，表示资源会在 <code>Wed, 22 Oct 2018 08:41:00 GMT</code> 后过期，需要再次请求。并且 <code>Expires</code> 受限于本地时间，如果修改了本地时间，可能会造成缓存失效。</p> <p><code>Cache-Control</code> 出现于 HTTP / 1.1，优先级高于 <code>Expires</code> 。该属性表示资源会在 30 秒后过期，需要再次请求。</p> <h3 id="协商缓存"><a href="#协商缓存" class="header-anchor">#</a> 协商缓存</h3> <p>如果缓存过期了，我们就可以使用协商缓存来解决问题。协商缓存需要请求，如果缓存有效会返回 304。</p> <p>协商缓存需要客户端和服务端共同实现，和强缓存一样，也有两种实现方式。</p> <h5 id="last-modified-和-if-modified-since"><a href="#last-modified-和-if-modified-since" class="header-anchor">#</a> <a href="https://yuchengkai.cn/docs/frontend/performance.html#last-modified-%E5%92%8C-if-modified-since" target="_blank" rel="noopener noreferrer">#<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>Last-Modified 和 If-Modified-Since</h5> <p><code>Last-Modified</code> 表示本地文件最后修改日期，<code>If-Modified-Since</code> 会将 <code>Last-Modified</code> 的值发送给服务器，询问服务器在该日期后资源是否有更新，有更新的话就会将新的资源发送回来。</p> <p>但是如果在本地打开缓存文件，就会造成 <code>Last-Modified</code> 被修改，所以在 HTTP / 1.1 出现了 <code>ETag</code> 。</p> <h5 id="etag-和-if-none-match"><a href="#etag-和-if-none-match" class="header-anchor">#</a> <a href="https://yuchengkai.cn/docs/frontend/performance.html#etag-%E5%92%8C-if-none-match" target="_blank" rel="noopener noreferrer">#<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ETag 和 If-None-Match</h5> <p><code>ETag</code> 类似于文件指纹，<code>If-None-Match</code> 会将当前 <code>ETag</code> 发送给服务器，询问该资源 <code>ETag</code> 是否变动，有变动的话就将新的资源发送回来。并且 <code>ETag</code> 优先级比 <code>Last-Modified</code> 高。</p> <ul><li>HTTP / 2 多路复用，多个请求使用同一个TCP连接，极大加快了网页的加载速度</li></ul> <h3 id="减少请求数"><a href="#减少请求数" class="header-anchor">#</a> 减少请求数</h3> <ul><li><p>JavaScript CSS 打包 压缩</p></li> <li><p>JavaScript控制图片 图片本身</p></li> <li><p>尽量使用 SVG 替代图片</p></li></ul> <h3 id="文件优化"><a href="#文件优化" class="header-anchor">#</a> 文件优化</h3> <ul><li>减少图片的数量</li> <li>小图片使用 base64</li> <li>能够显示 WebP 格式的浏览器尽量使用 WebP 格式。因为 WebP 格式具有更好的图像数据压缩算法，能带来更小的图片体积，而且拥有肉眼识别无差异的图像质量，缺点就是兼容性并不好</li> <li>小图使用 PNG，其实对于大部分图标这类图片，完全可以使用 SVG 代替</li> <li>照片使用 JPEG</li></ul> <h2 id="webpack"><a href="#webpack" class="header-anchor">#</a> Webpack</h2> <h4 id="优化输出-压缩文件"><a href="#优化输出-压缩文件" class="header-anchor">#</a> 优化输出 压缩文件</h4> <ul><li><p>production 模式会自动开启代码压缩模式</p></li> <li><p>压缩 JS  去掉无效js、日志、缩短变量名、压缩CSS</p></li> <li><p>开启 Tree shaking 移除没有用的代码，ES6 依赖 import export 模块化语法。<strong>它正常工作的前提是代码必须采用ES6的模块化语法</strong> 因为ES6模块化语法是静态的。</p></li> <li><p>优化图片</p></li> <li><p>按照路由拆分代码 实现按需加载</p></li> <li><p>给打包出来的文件名添加哈希，实现浏览器缓存文件</p></li></ul> <h3 id="分析工具"><a href="#分析工具" class="header-anchor">#</a> 分析工具</h3> <p><strong>webpack-bundle-analyzer</strong></p> <p>可视化分析工具，比Webapck Analyse更直观。使用也很简单：</p> <ol><li>npm  i -g webpack-bundle-analyzer安装到全局</li> <li>按照上面方法生成stats.json文件</li> <li>在项目根目录执行<code>webpack-bundle-analyzer</code> ，浏览器会自动打开结果分析页面。</li></ol> <h2 id="安全"><a href="#安全" class="header-anchor">#</a> 安全</h2> <h3 id="xss"><a href="#xss" class="header-anchor">#</a> XSS</h3> <blockquote><p><strong>跨网站指令码</strong>（英语：Cross-site scripting，通常简称为：XSS）是一种网站应用程式的安全漏洞攻击，是<a href="https://www.wikiwand.com/zh-hans/%E4%BB%A3%E7%A2%BC%E6%B3%A8%E5%85%A5" target="_blank" rel="noopener noreferrer">代码注入<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>的一种。它允许恶意使用者将程式码注入到网页上，其他使用者在观看网页时就会受到影响。这类攻击通常包含了 HTML 以及使用者端脚本语言。</p></blockquote> <p>XSS 通过修改 HTML 节点或者执行 JS 代码来攻击网站。<strong>把常用的符号进行转义，最普遍的做法是转义输入输出的内容，对于引号，尖括号，斜杠进行转义</strong></p> <h3 id="csp"><a href="#csp" class="header-anchor">#</a> CSP</h3> <p>内容安全策略 (<a href="https://developer.mozilla.org/en-US/docs/Glossary/CSP" target="_blank" rel="noopener noreferrer">CSP<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>) 是一个额外的安全层，用于检测并削弱某些特定类型的攻击，包括跨站脚本 (<a href="https://developer.mozilla.org/en-US/docs/Glossary/XSS" target="_blank" rel="noopener noreferrer">XSS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>) 和数据注入攻击等。无论是数据盗取、网站内容污染还是散发恶意软件，这些攻击都是主要的手段。</p> <h3 id="csrf"><a href="#csrf" class="header-anchor">#</a> CSRF</h3> <p><strong>跨站请求伪造</strong>（英语：Cross-site request forgery），也被称为 <strong>one-click attack</strong> 或者 <strong>session riding</strong>，通常缩写为 <strong>CSRF</strong> 或者 <strong>XSRF</strong>， 是一种挟制用户在当前已登录的 Web 应用程序上执行非本意的操作的攻击方法。[<a href="https://www.wikiwand.com/zh/%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0#citenoteRistic1" target="_blank" rel="noopener noreferrer">1]<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 跟<a href="https://www.wikiwand.com/zh/%E8%B7%A8%E7%B6%B2%E7%AB%99%E6%8C%87%E4%BB%A4%E7%A2%BC" target="_blank" rel="noopener noreferrer">跨網站指令碼<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>（XSS）相比，<strong>XSS</strong> 利用的是用户对指定网站的信任，CSRF 利用的是网站对用户网页浏览器的信任。</p> <ol><li>Get 请求不对数据进行修改</li> <li>不让第三方网站访问到用户 Cookie</li> <li>阻止第三方网站请求接口</li> <li>请求时附带验证信息，比如验证码或者 token</li></ol> <h4 id="samesite"><a href="#samesite" class="header-anchor">#</a> <a href="https://yuchengkai.cn/docs/frontend/safety.html#samesite" target="_blank" rel="noopener noreferrer">#<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>SameSite</h4> <p>可以对 Cookie 设置 <code>SameSite</code> 属性。该属性设置 Cookie 不随着跨域请求发送，该属性可以很大程度减少 CSRF 的攻击，但是该属性目前并不是所有浏览器都兼容。</p> <h4 id="验证-referer"><a href="#验证-referer" class="header-anchor">#</a> <a href="https://yuchengkai.cn/docs/frontend/safety.html#%E9%AA%8C%E8%AF%81-referer" target="_blank" rel="noopener noreferrer">#<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>验证 Referer</h4> <p>对于需要防范 CSRF 的请求，我们可以通过验证 Referer 来判断该请求是否为第三方网站发起的。</p> <h4 id="token"><a href="#token" class="header-anchor">#</a> <a href="https://yuchengkai.cn/docs/frontend/safety.html#token" target="_blank" rel="noopener noreferrer">#<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>Token</h4> <p>服务器下发一个随机 Token（算法不能复杂），每次发起请求时将 Token 携带上，服务器验证 Token 是否有效。</p> <h2 id="session"><a href="#session" class="header-anchor">#</a> session</h2> <p>服务端生成,存储于服务端的内存中,长时间不使用会过期,服务端会通过session判断请求是否来自同一个客户端</p> <h2 id="cookie"><a href="#cookie" class="header-anchor">#</a> cookie</h2> <p>一般也由服务端生成,存储在客户端,每次请求都会自动附上这个值</p> <ul><li>请求同域下的静态资源也会附上,会损耗资源</li></ul> <h2 id="token-2"><a href="#token-2" class="header-anchor">#</a> token</h2> <p>服务端生成,服务端可以不做存储,也可以做存储</p> <h3 id="不做存储"><a href="#不做存储" class="header-anchor">#</a> 不做存储</h3> <p>在 token中加入用户身份识别信息,过期时间,时间戳等等内容,然后进行过加密传输给客户端,
需要身份校验的接口,服务端就判断请求头是是否附带有token,如果有取出来解密然后执行后续操作</p> <h3 id="做存储"><a href="#做存储" class="header-anchor">#</a> 做存储</h3> <p>生成一段不重复的加密字符串token作为key,然后存放在服务端(通常是用redis,服务端重启也不会丢失用户的登录状态)使用key-value形式,value是用户信息,然后将token(key)发给客户端</p> <h2 id="跨域"><a href="#跨域" class="header-anchor">#</a> 跨域</h2> <p><strong>默认情况下，使用 API 的 Web 应用程序只能从加载应用程序的同一个域请求 HTTP 资源。如果域名、协议、端口号有一个不一致 这个请求就是跨域请求。</strong></p> <p>目前来看，同源策略会让三种行为受限：</p> <ul><li>Cookie、LocalStorage 和 IndexDB 访问受限</li> <li>无法操作跨域 DOM（常见于 iframe）</li> <li>Javascript 发起的 XHR 和 Fetch 请求受限</li></ul> <h3 id="为什么存在跨域？"><a href="#为什么存在跨域？" class="header-anchor">#</a> 为什么存在跨域？</h3> <p>如果你能让其他域跨域访问你的网站，甚至是操作你的DOM 是非常不安全的，所以为了不让我们自己在网站里面的内容随便被访问，这个策略保证我们只能访问同一站点的资源。</p> <h3 id="服务端-cors"><a href="#服务端-cors" class="header-anchor">#</a> 服务端 CORS</h3> <p>HTTP 响应添加一些响应字段 Access-Control-* 来表明是否允许跨域请求，根据这些 CORS 响应字段，浏览器可以允许一些被同源策略限制的跨源响应。</p> <ul><li>一个字段是<strong>必加</strong>的，那就是 <code>Access-Control-Allow-Origin</code>。这个头字段的值指定了哪些站点被允许跨域访问资源。</li> <li>另一个常见的响应头字段是 <code>Access-Control-Allow-Methods</code>。其指明了跨域请求所允许使用的 HTTP 方法。</li></ul> <h3 id="withcredentials"><a href="#withcredentials" class="header-anchor">#</a> withCredentials</h3> <p>CORS请求默认不发送Cookie和HTTP认证信息。如果要把Cookie发到服务器，一方面要服务器同意，指定<code>Access-Control-Allow-Credentials</code>字段。开发者必须在AJAX请求中打开<code>withCredentials</code>属性。</p> <p>如果要发送Cookie，<code>Access-Control-Allow-Origin</code>就不能设为星号，必须指定明确的、与请求网页一致的域名。同时，Cookie依然遵循同源政策，只有用服务器域名设置的Cookie才会上传，其他域名的Cookie并不会上传，且（跨源）原网页代码中的<code>document.cookie</code>也无法读取服务器域名下的Cookie。</p> <h3 id="跨域预检请求"><a href="#跨域预检请求" class="header-anchor">#</a> 跨域预检请求</h3> <p>CORS 有两种类型的请求：简单请求和 预检请求。</p> <p><strong>如果满足下面两个大条件就是简单请求</strong></p> <p>（1) 请求方法是以下三种方法之一：</p> <ul><li>HEAD</li> <li>GET</li> <li>POST</li></ul> <p>（2）HTTP的头信息不超出以下几种字段：</p> <ul><li>Accept</li> <li>Accept-Language</li> <li>Content-Language</li> <li>Last-Event-ID</li> <li>Content-Type：只限于三个值<code>application/x-www-form-urlencoded</code>、<code>multipart/form-data</code>、<code>text/plain</code></li></ul> <blockquote><p><strong>非简单请求的 CORS请求，会在正式通信之前，增加一次 域检请求 请求方法是 OPTIONS</strong></p> <ul><li>浏览器会先询问服务器，当前网页所在的域名是否在服务器的许可名单中，以及可以使用哪些HTTP头信息字段，只有得到答复 才会正式开始请求。</li> <li>服务器收到&quot;预检&quot;请求以后，检查了<code>Origin</code>、<code>Access-Control-Request-Method</code>和<code>Access-Control-Request-Headers</code>字段以后，确认允许跨源请求，就可以做出回应。</li> <li>如果预检响应没有检验通过，CORS 会阻止跨域访问，实际的请求永远不会被发送。预检请求是一种很好的方式，可以防止我们访问或修改那些没有启用 CORS 策略的服务器上的资源。</li></ul></blockquote> <h3 id="认证"><a href="#认证" class="header-anchor">#</a> 认证</h3> <p>一般而言，对于跨域 XHR 或 Fetch 请求，浏览器<strong>不会</strong>发送身份凭证信息。尽管 CORS 默认情况下不发送身份凭证，但我们可以通过添加 <code>Access-Control-Allow-Credentials</code> CORS 响应头来更改它。</p> <p>如果要在跨域请求中包含 cookie 和其他授权信息，我们需要做以下操作：</p> <ul><li>XHR 请求中将 <code>withCredentials</code> 字段设置为 <code>true</code></li> <li>Fetch 请求中将 <code>credentials</code> 设为 <code>include</code></li> <li>服务器把 <code>Access-Control-Allow-Credentials: true</code> 添加到响应头中</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// fetch 请求</span>
<span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'https://api.mywebsite.com/users'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">credentials</span><span class="token operator">:</span> <span class="token string">'include'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 浏览器 XHR 请求</span>
<span class="token keyword">let</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span>withCredentials <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

<span class="token comment">// 服务器添加认证字段</span>
<span class="token constant">HTTP</span><span class="token operator">/</span><span class="token number">1.1</span> <span class="token number">200</span> <span class="token constant">OK</span>
Access<span class="token operator">-</span>Control<span class="token operator">-</span>Allow<span class="token operator">-</span>Credentials<span class="token operator">:</span> <span class="token boolean">true</span>
</code></pre></div><h2 id="webscoket"><a href="#webscoket" class="header-anchor">#</a> webscoket</h2> <p>早期为了网站长连接，传统模式使用的都是轮询来做。浏览器需要不断向服务器请求，而HTTP请求里面带的信息真正能被使用的只有一小部分，如果轮询请求会造成带宽资源的浪费。<strong>Comet虽然可以双向通信 但是还是要反复请求。</strong> HTML5 定义了新的协议 WebScoket协议，能更好的节省服务器资源和带宽。而且能够实时进行通信，<strong>Websocket 使⽤ ws 或 wss 的统⼀资源标志符（URI），其中 wss 表示使⽤了 TLS 的Websocket</strong></p> <p>WebScoket 也是基于TCP连接，默认80端口，如果是运行在TLS之上就是 443端口。</p> <p>WebScoket是网络传输协议，在单个TCP连接上进行全双工通信，在应用层。标准化为 RFC 6455，后由 RFC 7936 补充规范。<strong>允许服务端主动想客户端推送数据，浏览器只要和服务器完成一次握手，就可以创建持久化的连接，进行双向数据传输。</strong></p> <h3 id="优点"><a href="#优点" class="header-anchor">#</a> 优点</h3> <ul><li>较少的控制开销 连接创建之后，服务端和客户端之间交换数据时，用于协议控制的数据包头部相对较小</li> <li>更强的实时性，协议是全双工，所以服务器可以随时主动给客户端下发数据。相对于HTTP请求需要等待客户端发起请求服务端才能响应</li> <li>保持连接性</li> <li>更好的二进制支持，轻松处理二进制内容</li> <li>支持扩展 可以扩展协议，实现部分自定义的子协议</li></ul> <h2 id="socket"><a href="#socket" class="header-anchor">#</a> Socket</h2> <p>网络上两个程序通过一个双向的通信连接实现数据的交换，连接的一端称为一个 socket（套接字），因此建立网络通信连接至少要一对端口号，<strong>socket本质上是对 TCP/IP 协议栈的封装，提供了一个针对TCP或者UDP编程的接口，并不是另一种协议。</strong></p> <ul><li>它可以实现底层通信，几乎所有的应用层都是通过 socket进行通信的</li> <li>对TCP/IP 协议进行封装，便于应用层协议调用，属于二者之间的中间抽象层</li> <li>TCP /IP 协议中，UDP、TCP 两种协议都不同，不同参数的socket实现过程也不一样。</li></ul> <h3 id="arraybuffer"><a href="#arraybuffer" class="header-anchor">#</a> ArrayBuffer</h3> <p>ArrayBuffer 对象表示固定长度的二进制数据缓冲区。ArrayBuffer不能直接操作，而是要<strong>通过类数组对象或者 DataView 对象来操作</strong>，<strong>ArrayBuffer是一片内存，不能直接使用，需要装换可以使用的实际类型。这就是TypeArray的作用，</strong></p> <blockquote><p><strong>const buffer = new ArrayBuffer(length); // length 创建的大小 字符是字节</strong></p> <p><strong>const typeArray = new UInt16Array(buffer)</strong></p> <p><strong>这里有两个几个注意的地方</strong></p> <ul><li>ArrayBuffer 的参数length指定的是字符大小，会根据这个参数在内存开辟多大的空间</li> <li>TypeArray不同的类型 每个元素占用的字符数是不一样的，比如Int16Array 每个元素占两个字节，32占4个字节</li> <li>typeArray的元素赋值，如果超过了这个字符数，超过的位会置零 如下代码</li></ul></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> myArray <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayBuffer</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> buffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span>myArray<span class="token punctuation">)</span><span class="token punctuation">;</span>

buffer<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">32</span><span class="token punctuation">;</span>
<span class="token comment">// 越界的值会直接切断</span>
buffer<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">549</span><span class="token punctuation">;</span> 
<span class="token comment">// 549的二进制表示 100100101 一个元素占一个字节，那么第一个1会置零 就是 00100101 =&gt; 37</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>buffer<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 37</span>
</code></pre></div></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/facebook201/sy-fontend-system/edit/master/docs/fontEnd/Browser/README.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/syBlog/fontEnd/Browser/browser.html">
          工作原理
        </a>
        →
      </span></p></div> </div></div></div>
    <script src="/syBlog/assets/js/app.a437376f.js" defer></script><script src="/syBlog/assets/js/46.6e1f18b0.js" defer></script>
  </body>
</html>
